<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=UTF-8" http-equiv="Content-Type">
    <title>Legion</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script type="text/javascript" src="jquery.js"></script>
    <script language="javascript" type="text/javascript">
// TODO : récupérer ca au chargement
var champs = ['Nom', 'Prénom', 'Classe', 'Année']
function init(){
    // Initialisation de l'application
    var ligne = "";
    for (var i=0;i<champs.length;i++) {
        ligne += "<th>"+champs[i]+"</th>\n";
    }
    $('#vue').append( "<tr>"+ligne+"</tr>\n" );
}
function liste() {
    // Liste la contenu de la base
    $.get( "/requete?liste", function( data ) {
        var ligne = "";
        $.each( data, function( key, value ) {
            var vals = "";
            for (var i=0;i<champs.length;i++) {
                c = champs[i];
                vals += "<td>"+value[c]+"</td>";
            }
            ligne += "<tr>"+vals+"</tr>\n";
        });
        $('#vue').append( ligne );
    });
}
function importation() {
    // Importation d'un csv
    // TODO : envoie du fichier
    $.get( "/requete?importation", function( data ) {
        $('#notifications').html(data);
    });
}
    </script>
  </head>
  <body onLoad="init();">
    <h1>Legion</h1>
    Application de suivi de cohorte.
    <input type="button" value="Lister base" onClick="liste();">
    <div id="notifications" class="notification"></div>
    <h3>Vue (format d'affichage)</h3>
    <table id="vue" border="1">
    </table>
    <table border="1">
        <tr>
            <th>Nom</th>
            <th>Prénom</th>
            <th>Parcours</th>
            <th>Date entrée / sortie / différence</th>
            <th>Diplômé ?</th>
            <th>Après (3 mois / 1 an)</th>
        </tr>
    </table>
    <h3>Fonctionnalités</h3>
    Recherche : <input type="text"> / type de recherche : <select>
        <option>Nom</option>
        <option>Classe</option>
        <option>INE</option>
        <option><i>Tout</i></option>
    </select>
    <br>
    <br>
    <input type="file" id="csv">
    <input type="button" value="Importer des données" onClick="importation();">
    <h3>Statistiques</h3>
    Stats sur une cohorte :
    <table border="1">
        <caption>Pour l'année <select>
                <option>1168</option>
                <option>1169</option>
                <option selected=selected>2013</option>
                <option>Toutes</option>
            </select></caption>
        <tr>
            <th>Classe</th>
            <th>Redoublant</th>
            <th>...</th>
        </tr>
        <tr>
            <td>1erES1</td>
            <td>4 / 23</td>
            <td>...</td>
        </tr>
    </table>
  </body>
</html>
